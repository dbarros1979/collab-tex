<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collab-Tex - Online LaTeX Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS Variables for consistent theming */
        :root {
            --primary-color: #1a73e8;
            --secondary-color: #34a853;
            --danger-color: #ea4335;
            --warning-color: #fbbc04;
            --dark-bg: #202124;
            --sidebar-bg: #2d2e31;
            --editor-bg: #1e1e1e;
            --text-light: #ffffff;
            --text-dark: #333333;
            --text-muted: #9aa0a6;
            --border-color: #3c4043;
            --hover-color: #35363a;
            --header-height: 50px;
            --sidebar-width: 280px;
            --footer-height: 30px;
        }

        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            height: 100vh;
            overflow: hidden;
            background-color: var(--dark-bg);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
        }

        /* Header styles */
        .header {
            height: var(--header-height);
            background-color: var(--dark-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .logo i {
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .branch-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select {
            background: var(--sidebar-bg);
            color: var(--text-light);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 0.9rem;
        }

        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: background 0.2s;
        }

        .btn:hover {
            background: #0d62d0;
        }

        .btn-secondary {
            background: var(--sidebar-bg);
        }

        .btn-secondary:hover {
            background: var(--hover-color);
        }

        .btn-success {
            background: var(--secondary-color);
        }

        .btn-success:hover {
            background: #2e9845;
        }

        /* Main container */
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar styles */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-section {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-section h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-tree {
            flex: 1;
            overflow-y: auto;
        }

        .file-list {
            list-style: none;
        }

        .file-item,
        .folder-item {
            padding: 8px 10px;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .file-item:hover,
        .folder-item:hover {
            background: var(--hover-color);
        }

        .file-item.active {
            background: var(--primary-color);
        }

        .file-item i {
            color: var(--text-muted);
            width: 16px;
            text-align: center;
        }

        .file-item.active i {
            color: white;
        }

        .folder-contents {
            padding-left: 20px;
            display: none;
        }

        .folder-item.expanded+.folder-contents {
            display: block;
        }

        .folder-item i {
            transition: transform 0.2s;
        }

        .folder-item.expanded i {
            transform: rotate(90deg);
        }

        /* Editor area styles */
        .editor-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .editor-tabs {
            display: flex;
            background: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
        }

        .editor-tab {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            border-right: 1px solid var(--border-color);
            white-space: nowrap;
            transition: background 0.2s;
        }

        .editor-tab:hover {
            background: var(--hover-color);
        }

        .editor-tab.active {
            background: var(--editor-bg);
        }

        .editor-tab-close {
            margin-left: 5px;
            opacity: 0.7;
        }

        .editor-tab-close:hover {
            opacity: 1;
        }

        .editor-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .code-panel,
        .preview-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .panel-header {
            padding: 8px 15px;
            background: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .panel-controls {
            display: flex;
            gap: 10px;
        }

        .resize-handle {
            width: 5px;
            background: var(--border-color);
            cursor: col-resize;
            transition: background 0.2s;
        }

        .resize-handle:hover {
            background: var(--primary-color);
        }

        #texEditor {
            flex: 1;
            background: var(--editor-bg);
            color: var(--text-light);
            border: none;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            outline: none;
            white-space: pre;
            overflow: auto;
        }

        #pdfFrame {
            flex: 1;
            border: none;
            background: white;
        }

        /* Footer styles */
        .footer {
            height: var(--footer-height);
            background: var(--dark-bg);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .status-indicators {
            display: flex;
            gap: 15px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Compilation log styles */
        .compilation-log {
            background: var(--dark-bg);
            border-top: 1px solid var(--border-color);
            max-height: 150px;
            overflow-y: auto;
            display: none;
        }

        .log-header {
            padding: 8px 15px;
            background: var(--sidebar-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .log-content {
            padding: 10px 15px;
            font-family: monospace;
            font-size: 0.8rem;
            white-space: pre-wrap;
        }

        .log-success {
            color: var(--secondary-color);
        }

        .log-error {
            color: var(--danger-color);
        }

        .log-warning {
            color: var(--warning-color);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: 200px;
            }

            .editor-container {
                flex-direction: column;
            }

            .code-panel,
            .preview-panel {
                height: 50%;
            }

            .resize-handle {
                width: 100%;
                height: 5px;
                cursor: row-resize;
            }
        }

        /* Animation for compilation status */
        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        .compiling {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>

<body>
    <!-- Header with controls -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-code"></i>
            <span>Collab-Tex</span>
        </div>
        <div class="header-controls">
            <div class="branch-selector">
                <i class="fas fa-code-branch"></i>
                <select id="branchSelect">
                    <option value="main">main</option>
                    <option value="develop">develop</option>
                    <option value="feature-x">feature-x</option>
                </select>
            </div>
            <button class="btn" id="compileBtn">
                <i class="fas fa-play"></i> Compile
            </button>
            <button class="btn btn-success" id="saveBtn">
                <i class="fas fa-save"></i> Save
            </button>
            <button class="btn btn-secondary" id="reloadBtn">
                <i class="fas fa-redo"></i> Reload PDF
            </button>
        </div>
    </div>

    <!-- Main container with sidebar and editor -->
    <div class="container">
        <!-- Sidebar with file tree -->
        <div class="sidebar">
            <div class="sidebar-section">
                <h3><i class="fas fa-project-diagram"></i> Project Files</h3>
                <div class="file-tree">
                    <ul class="file-list" id="fileList">
                        <li class="file-item active" data-file="main.tex">
                            <i class="fas fa-file-code"></i> main.tex
                        </li>
                        <li class="file-item" data-file="references.bib">
                            <i class="fas fa-file-alt"></i> references.bib
                        </li>
                        <li class="folder-item">
                            <i class="fas fa-folder"></i> figures
                        </li>
                        <div class="folder-contents">
                            <li class="file-item" data-file="figures/diagram1.png">
                                <i class="fas fa-file-image"></i> diagram1.png
                            </li>
                            <li class="file-item" data-file="figures/chart.pdf">
                                <i class="fas fa-chart-bar"></i> chart.pdf
                            </li>
                        </div>
                    </ul>
                </div>
            </div>
            <div class="sidebar-section">
                <h3><i class="fas fa-users"></i> Collaborators</h3>
                <div id="collaboratorsList">
                    <div class="user-item">
                        <i class="fas fa-user"></i> dbarros1979 (You)
                    </div>
                    <!-- More users would appear here in a real implementation -->
                </div>
            </div>
        </div>

        <!-- Editor area with tabs and panels -->
        <div class="editor-area">
            <div class="editor-tabs" id="editorTabs">
                <div class="editor-tab active" data-file="main.tex">
                    <i class="fas fa-file-code"></i> main.tex
                    <span class="editor-tab-close"><i class="fas fa-times"></i></span>
                </div>
                <!-- More tabs would appear here as files are opened -->
            </div>

            <div class="editor-container">
                <!-- Code editor panel -->
                <div class="code-panel">
                    <div class="panel-header">
                        <span class="panel-title" id="currentFile">main.tex</span>
                        <div class="panel-controls">
                            <button class="btn btn-secondary" id="undoBtn" title="Undo">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button class="btn btn-secondary" id="redoBtn" title="Redo">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                    </div>
                    <textarea id="texEditor" spellcheck="false"></textarea>
                </div>

                <!-- Resize handle -->
                <div class="resize-handle" id="resizeHandle"></div>

                <!-- PDF preview panel -->
                <div class="preview-panel">
                    <div class="panel-header">
                        <span class="panel-title">PDF Preview</span>
                        <div class="panel-controls">
                            <button class="btn btn-secondary" id="fullscreenBtn" title="Fullscreen">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="btn btn-secondary" id="downloadBtn" title="Download PDF">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <iframe id="pdfFrame" src="main/main.pdf"></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Compilation log -->
    <div class="compilation-log" id="compilationLog">
        <div class="log-header">
            <span>Compilation Log</span>
            <button class="btn btn-secondary" id="toggleLog">
                <i class="fas fa-chevron-up"></i>
            </button>
        </div>
        <div class="log-content" id="logContent"></div>
    </div>

    <!-- Footer with status information -->
    <div class="footer">
        <div class="status-indicators">
            <div class="status-item">
                <i class="fas fa-circle" id="connectionStatus" style="color: var(--secondary-color);"></i>
                <span>Connected</span>
            </div>
            <div class="status-item">
                <i class="fas fa-save" id="saveStatus"></i>
                <span>All changes saved</span>
            </div>
        </div>
        <div class="status-item">
            <span id="statusMessage">Ready</span>
        </div>
    </div>

    <script>
        // Application state
        let currentBranch = 'main';
        let currentFile = 'main.tex';
        let fileContents = {};
        let openTabs = ['main.tex'];
        let isCompiling = false;
        let isLoggedIn = false; // Would be set based on authentication

        // DOM elements
        const branchSelect = document.getElementById('branchSelect');
        const fileList = document.getElementById('fileList');
        const editorTabs = document.getElementById('editorTabs');
        const texEditor = document.getElementById('texEditor');
        const pdfFrame = document.getElementById('pdfFrame');
        const currentFileElement = document.getElementById('currentFile');
        const compileBtn = document.getElementById('compileBtn');
        const reloadBtn = document.getElementById('reloadBtn');
        const saveBtn = document.getElementById('saveBtn');
        const undoBtn = document.getElementById('undoBtn');
        const redoBtn = document.getElementById('redoBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const toggleLog = document.getElementById('toggleLog');
        const compilationLog = document.getElementById('compilationLog');
        const logContent = document.getElementById('logContent');
        const statusMessage = document.getElementById('statusMessage');
        const connectionStatus = document.getElementById('connectionStatus');
        const saveStatus = document.getElementById('saveStatus');
        const resizeHandle = document.getElementById('resizeHandle');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
            setupEventListeners();
            loadBranch();
            loadFile('main.tex');
        });

        // Initialize application state and UI
        function initializeApp() {
            // Set up initial file contents (in a real app, this would come from GitHub API)
            fileContents['main.tex'] = `\\documentclass{article}
\\usepackage[utf8]{inputenc}
\\usepackage{graphicx}

\\title{Collab-Tex: A Collaborative LaTeX Editor}
\\author{Your Name}
\\date{\\today}

\\begin{document}

\\maketitle

\\section{Introduction}
This is a collaborative LaTeX document edited using Collab-Tex.

\\section{Features}
\\begin{itemize}
    \\item Real-time collaboration
    \\item Automatic PDF compilation
    \\item GitHub integration
    \\item Overleaf-like interface
\\end{itemize}

\\section{Conclusion}
Collab-Tex makes LaTeX collaboration simple and accessible.

\\bibliographystyle{plain}
\\bibliography{references}

\\end{document}`;

            fileContents['references.bib'] = `@article{collabtex2023,
    title = {Collab-Tex: Redesigning Academic LaTeX Collaboration},
    author = {Author, A. and Collaborator, B.},
    journal = {Journal of Open Source Software},
    year = {2023},
    volume = {8},
    number = {90},
    pages = {1--5}
}`;

            // Initialize UI state
            updateSaveStatus(true);
            updateConnectionStatus(true);
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Branch selection
            branchSelect.addEventListener('change', loadBranch);

            // Control buttons
            compileBtn.addEventListener('click', compileProject);
            reloadBtn.addEventListener('click', reloadPDF);
            saveBtn.addEventListener('click', saveFile);
            undoBtn.addEventListener('click', undoEdit);
            redoBtn.addEventListener('click', redoEdit);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            downloadBtn.addEventListener('click', downloadPDF);
            toggleLog.addEventListener('click', toggleCompilationLog);

            // File navigation
            fileList.addEventListener('click', handleFileClick);

            // Editor tabs
            editorTabs.addEventListener('click', handleTabClick);

            // Text editor changes
            texEditor.addEventListener('input', handleEditorInput);

            // Resize handle for panels
            setupResizeHandle();

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);
        }

        // Handle file clicks in the sidebar
        function handleFileClick(e) {
            const fileItem = e.target.closest('.file-item');
            const folderItem = e.target.closest('.folder-item');

            if (fileItem) {
                const fileName = fileItem.getAttribute('data-file');
                openFile(fileName);
            } else if (folderItem) {
                folderItem.classList.toggle('expanded');
            }
        }

        // Handle tab clicks in the editor area
        function handleTabClick(e) {
            const tab = e.target.closest('.editor-tab');
            const closeBtn = e.target.closest('.editor-tab-close');

            if (closeBtn && tab) {
                closeTab(tab.getAttribute('data-file'));
            } else if (tab) {
                switchToTab(tab.getAttribute('data-file'));
            }
        }

        // Handle editor input changes
        function handleEditorInput() {
            fileContents[currentFile] = texEditor.value;
            updateSaveStatus(false);
        }

        // Handle keyboard shortcuts
        function handleKeyboardShortcuts(e) {
            // Ctrl+S or Cmd+S to save
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                saveFile();
            }

            // Ctrl+Enter or Cmd+Enter to compile
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                compileProject();
            }
        }

        // Set up resize handle for editor panels
        function setupResizeHandle() {
            let isResizing = false;

            resizeHandle.addEventListener('mousedown', function (e) {
                isResizing = true;
                document.addEventListener('mousemove', handleResize);
                document.addEventListener('mouseup', stopResize);
            });

            function handleResize(e) {
                if (!isResizing) return;

                const container = document.querySelector('.editor-container');
                const containerRect = container.getBoundingClientRect();
                const percentage = (e.clientX - containerRect.left) / containerRect.width;

                document.querySelector('.code-panel').style.flex = percentage;
                document.querySelector('.preview-panel').style.flex = 1 - percentage;
            }

            function stopResize() {
                isResizing = false;
                document.removeEventListener('mousemove', handleResize);
                document.removeEventListener('mouseup', stopResize);
            }
        }

        // Load selected branch
        function loadBranch() {
            currentBranch = branchSelect.value;
            statusMessage.textContent = `Loading branch: ${currentBranch}`;

            // Update PDF preview
            const pdfUrl = `https://dbarros1979.github.io/collab-tex/${currentBranch}/main.pdf`;
            pdfFrame.src = pdfUrl;

            // In a real implementation, we would fetch the file list from GitHub API
            simulateFileListLoad();

            statusMessage.textContent = `Branch loaded: ${currentBranch}`;
            addToLog(`Switched to branch: ${currentBranch}`, 'info');
        }

        // Simulate loading file list (would use GitHub API in production)
        function simulateFileListLoad() {
            statusMessage.textContent = 'File list loaded from repository';
        }

        // Open a file in the editor
        function openFile(fileName) {
            // Update file list selection
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`.file-item[data-file="${fileName}"]`).classList.add('active');

            // Add tab if not already open
            if (!openTabs.includes(fileName)) {
                openTabs.push(fileName);
                addTab(fileName);
            }

            // Switch to the tab
            switchToTab(fileName);
        }

        // Add a new editor tab
        function addTab(fileName) {
            const tab = document.createElement('div');
            tab.className = 'editor-tab';
            tab.setAttribute('data-file', fileName);

            // Extract file icon based on extension
            const icon = getFileIcon(fileName);
            const name = fileName.split('/').pop();

            tab.innerHTML = `
                ${icon} ${name}
                <span class="editor-tab-close"><i class="fas fa-times"></i></span>
            `;

            editorTabs.appendChild(tab);
        }

        // Switch to a specific tab
        function switchToTab(fileName) {
            // Update tab states
            document.querySelectorAll('.editor-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.editor-tab[data-file="${fileName}"]`).classList.add('active');

            // Update current file and load content
            currentFile = fileName;
            currentFileElement.textContent = fileName;
            texEditor.value = fileContents[fileName] || '';

            // Update save status
            updateSaveStatus(true);
        }

        // Close a tab
        function closeTab(fileName) {
            // Don't close the last tab
            if (openTabs.length <= 1) return;

            // Remove from open tabs
            const tabIndex = openTabs.indexOf(fileName);
            openTabs.splice(tabIndex, 1);

            // Remove tab element
            const tabElement = document.querySelector(`.editor-tab[data-file="${fileName}"]`);
            tabElement.remove();

            // If we're closing the active tab, switch to another one
            if (currentFile === fileName) {
                const newActiveTab = openTabs[Math.max(0, tabIndex - 1)];
                switchToTab(newActiveTab);
            }
        }

        // Get appropriate file icon based on extension
        function getFileIcon(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            switch (ext) {
                case 'tex': return '<i class="fas fa-file-code"></i>';
                case 'bib': return '<i class="fas fa-file-alt"></i>';
                case 'png':
                case 'jpg':
                case 'jpeg':
                case 'gif': return '<i class="fas fa-file-image"></i>';
                case 'pdf': return '<i class="fas fa-file-pdf"></i>';
                default: return '<i class="fas fa-file"></i>';
            }
        }

        // Compile the LaTeX project
        function compileProject() {
            if (isCompiling) return;

            isCompiling = true;
            compileBtn.classList.add('compiling');
            statusMessage.textContent = 'Compiling...';

            // In a real implementation, this would trigger a GitHub Actions workflow
            // For now, we simulate the compilation process
            simulateCompilation();
        }

        // Simulate the compilation process
        function simulateCompilation() {
            addToLog('Starting compilation...', 'info');

            // Simulate compilation steps with delays
            setTimeout(() => {
                addToLog('Running pdflatex...', 'info');
            }, 500);

            setTimeout(() => {
                addToLog('Running bibtex...', 'info');
            }, 1000);

            setTimeout(() => {
                addToLog('Running pdflatex (second pass)...', 'info');
            }, 1500);

            setTimeout(() => {
                addToLog('Running pdflatex (final pass)...', 'info');
                addToLog('Compilation successful!', 'success');

                isCompiling = false;
                compileBtn.classList.remove('compiling');
                statusMessage.textContent = 'Compilation complete';

                // Reload PDF after a short delay to ensure it's updated
                setTimeout(() => {
                    reloadPDF();
                }, 300);
            }, 2000);
        }

        // Reload the PDF preview
        function reloadPDF() {
            const currentSrc = pdfFrame.src;
            pdfFrame.src = currentSrc.split('?')[0] + '?t=' + new Date().getTime();
            statusMessage.textContent = 'PDF reloaded';
        }

        // Save the current file
        function saveFile() {
            // In a real implementation, this would commit changes to GitHub
            statusMessage.textContent = `Saving ${currentFile}...`;

            // Simulate API call delay
            setTimeout(() => {
                statusMessage.textContent = `Saved: ${currentFile}`;
                updateSaveStatus(true);
                addToLog(`Saved ${currentFile}`, 'info');
            }, 500);
        }

        // Undo last edit
        function undoEdit() {
            // Basic undo functionality (would be more sophisticated in a real editor)
            statusMessage.textContent = 'Undo';
            // Implementation would require maintaining an edit history
        }

        // Redo last undone edit
        function redoEdit() {
            // Basic redo functionality
            statusMessage.textContent = 'Redo';
            // Implementation would require maintaining an edit history
        }

        // Toggle fullscreen mode for PDF preview
        function toggleFullscreen() {
            if (pdfFrame.requestFullscreen) {
                pdfFrame.requestFullscreen();
            } else if (pdfFrame.webkitRequestFullscreen) {
                pdfFrame.webkitRequestFullscreen();
            }
            // Note: Fullscreen API has limited support for iframes
            statusMessage.textContent = 'Fullscreen mode';
        }

        // Download the current PDF
        function downloadPDF() {
            const pdfUrl = pdfFrame.src;
            const a = document.createElement('a');
            a.href = pdfUrl;
            a.download = `document-${currentBranch}-${new Date().toISOString().split('T')[0]}.pdf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            statusMessage.textContent = 'Downloading PDF...';
        }

        // Toggle compilation log visibility
        function toggleCompilationLog() {
            const isVisible = compilationLog.style.display !== 'none';
            compilationLog.style.display = isVisible ? 'none' : 'block';
            toggleLog.innerHTML = isVisible ?
                '<i class="fas fa-chevron-down"></i>' :
                '<i class="fas fa-chevron-up"></i>';
        }

        // Add a message to the compilation log
        function addToLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logContent.appendChild(logEntry);
            logContent.scrollTop = logContent.scrollHeight;
        }

        // Update the save status indicator
        function updateSaveStatus(saved) {
            if (saved) {
                saveStatus.className = 'fas fa-check';
                saveStatus.style.color = 'var(--secondary-color)';
            } else {
                saveStatus.className = 'fas fa-circle';
                saveStatus.style.color = 'var(--warning-color)';
            }
        }

        // Update the connection status indicator
        function updateConnectionStatus(connected) {
            if (connected) {
                connectionStatus.style.color = 'var(--secondary-color)';
            } else {
                connectionStatus.style.color = 'var(--danger-color)';
            }
        }

        // Load file content into editor
        function loadFile(fileName) {
            currentFile = fileName;
            currentFileElement.textContent = fileName;

            // In a real implementation, this would fetch content from GitHub API
            if (fileContents[fileName]) {
                texEditor.value = fileContents[fileName];
            } else {
                texEditor.value = `% File: ${fileName}\n% This file is empty. Start editing!`;
                fileContents[fileName] = texEditor.value;
            }

            statusMessage.textContent = `Loaded: ${fileName}`;
        }
    </script>
</body>

</html>